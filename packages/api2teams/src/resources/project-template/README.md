# Overview
> The `api2teams` and its generated project template is currently under active development. Report any issues to us [here](https://github.com/OfficeDev/TeamsFx/issues/new/choose)

This is an automatically generated Teams application template to a [command and response](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/command-bot-in-teams) style bot application based on the Open API specification using [api2teams](https://github.com/OfficeDev/TeamsFx/tree/api2teams/packages/api2teams). 

The API operation is converted to a [Teams bot chat command](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/create-a-bot-commands-menu?tabs=desktop%2Cdotnet) and api response and user interactions are converted into [Adaptive Cards](https://learn.microsoft.com/microsoftteams/platform/task-modules-and-cards/cards/cards-reference#adaptive-card).



## Get Started with generated app template

> To run this generated app template in your local dev machine, you will need:

> - [Node.js](https://nodejs.org/), supported versions: 14, 16, 18
> - An [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)
> - [Teams Toolkit for Visual Studio Code ](https://aka.ms/teams-toolkit) version 5.0.0 or higher or [Teams Toolkit CLI](https://aka.ms/teamsfx-cli)

>  **Note**
> Your app can be installed into a team, or a group chat, or as personal app. See [Installation and Uninstallation](https://aka.ms/teamsfx-command-new#customize-installation).
>

1. First, select the Teams Toolkit icon on the left in the VS Code toolbar.
1. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.
1. Press F5 to start debugging which launches your app in Teams using a web browser. Select `Debug (Edge)` or `Debug (Chrome)`.
1. When Teams launches in the browser, select the Add button in the dialog to install your app to Teams.
1. Click message input dialog, you can see supported commands.
1. Input command in the chat and send it to bot, and then you can get adaptive card

## What's included in the template

The app template is generated based on a command bot project that's compatible with Teams Toolkit project structures.

| Folder / File | Contents |
| - | - |
| `teamsapp.yml` | Main project file describes your application configuration and defines the set of actions to run in each lifecycle stages |
| `teamsapp.local.yml`| This overrides `teamsapp.yml` with actions that enable local execution and debugging |
| `env/`| Name / value pairs are stored in environment files and used by `teamsapp.yml` to customize the provisioning and deployment rules |
| `.vscode/` | VSCode files for debugging |
| `appPackage/` | Templates for the Teams application manifest |
| `infra/` | Templates for provisioning Azure resources |
| `src/` | The source code for the application |

The files in following folder can be customized and demonstrate an example implementation to ge you started.

| Folder / File | Contents |
| - | - |
|`src/adaptiveCards`|This folder contains adaptive card generated by `api2teams` based on the Open API Specification. Each API will generate two adaptive cards, one is `*RequestCard.json`, and another is `*ResponseCard.json`. Request card is for user to input parameters and click button to send request, and response card is used to render api response data. Using this pattern is more clear than use component name (although it may produce duplicated cards), because component name can be used by multiple apis, and it is not easy for user to know which adaptive card is for specific api|
|`src/apis`|This folder contains two `.ts` file, one is for mock api calls (`mockApiProvider.ts`) and another is for real api calls (`realApiProvider.ts`). For real api calls, you need to update these files to call backend service.|
|`src/cardActions`|This folder contains [card action handlers](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/workflow-bot-in-teams?tabs=JS#card-action-handler), when user click action button in the request adaptive card, it would use these handlers to get response and render response adaptive card.|
|`src/commands`|This folder contains bot [command handlers](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/command-bot-in-teams#command-and-response), when user send messages, it will match the api, and send back request adaptive card. There is a special command handler which named `helpCommandHandler` which is used to show help messages.|
|`src/index.ts`|Index file using `restify` as web service framework to host bot server, and register command handlers and action handlers for bot to handle use messages and button clicking event. |

## How it works
Below is a simple command and response flow chart:

![](https://github.com/OfficeDev/TeamsFx/wiki/api2teams/flow2.png)


In case the command requires additional input, the following flow will be triggered:
![](https://github.com/OfficeDev/TeamsFx/wiki/api2teams/flow1.png)

## Extend the template
Congratulations, you've just had your API integrated with Teams! Now you can further extend this template that fits with your business requirements:

- [Customize the trigger pattern](https://aka.ms/teamsfx-command-new#customize-the-trigger-pattern)
- [Customize the Adaptive Card with dynamic content](https://aka.ms/teamsfx-command-new#how-to-build-command-response-using-adaptive-card-with-dynamic-content)
- [Change the way to initialize the bot](https://aka.ms/teamsfx-command-new#customize-initialization)
- [Connect to an existing API](https://aka.ms/teamsfx-command-new#connect-to-existing-api)
- [Access Microsoft Graph](https://aka.ms/teamsfx-add-sso-new)
- [Add notifications to the project](https://aka.ms/teamsfx-notification-new)

## Current limitations
1. The `api2teams` doesn't support Open API schema version < 3.0.0.
1. The `api2teams` doesn't support Authorization property in Open API specification.
1. The `api2teams` doesn't support `webhooks` property and it would be ignored during convert.
1. The `api2teams` doesn't support `oneOf`, `anyOf`, `not`keyword (It only support `allOf` keyword currently).
1. The `api2teams` doesn't support `POST`, `PUT`, `PATCH` or `DELETE` operations (It only supports `GET` operation currently).
1. The generated Adaptive Card doesn't support array type. 
1. The generated Adaptive Card doesn't support file upload.
1. The generated Teams app can only contain up to 10 items in the command menu.
