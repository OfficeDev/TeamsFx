name: Templates Dependencies New Version Released
on:
  workflow_dispatch:
  schedule:
    - cron: "0 0 * * *"

jobs:
  notification:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Install npm packages
        run: |
          npm install axios
          npm install glob

      - name: Get All Updated Templates Dependencies
        id: getUpdatedTemplatesDependencies
        run: |
          echo 'result<<EOF' >> $GITHUB_OUTPUT
          echo "$(node ./.github/scripts/get-dailydigest-dependencies.js)" >> $GITHUB_OUTPUT
          echo 'EOF' >> $GITHUB_OUTPUT

      - name: Echo result
        if: ${{ always() }}
        run: |
          echo "${{ steps.getUpdatedTemplatesDependencies.outputs.result }}"

      # - name: Setup Email and Recipient
      #   if: ${{ contains(steps.getLTSVersion.outputs.result, 'v') }}
      #   id: email
      #   run: |
      #     emails="yiqingzhao@microsoft.com"
      #     subject="Bot Framework JS SDK ${{steps.getLTSVersion.outputs.result}} Released"
      #     body="Botbuilder ${{steps.getLTSVersion.outputs.result}} has been released.\n Details can be found here: https://github.com/microsoft/botbuilder-js/releases"

      #     echo "to=$emails" >> $GITHUB_OUTPUT
      #     echo "subject=$subject" >> $GITHUB_OUTPUT
      #     echo "body=$body" >> $GITHUB_OUTPUT

      # - name: Send E-mail Notifications
      #   uses: ./.github/actions/send-email-report
      #   env:
      #     TO: ${{ steps.email.outputs.to }}
      #     BODY: '"${{ steps.email.outputs.body }}"'
      #     SUBJECT: ${{ steps.email.outputs.subject }}
      #     MAIL_CLIENT_ID: ${{ secrets.TEST_CLEAN_CLIENT_ID }}
      #     MAIL_CLIENT_SECRET: ${{ secrets.TEST_CLEAN_CLIENT_SECRET }}
      #     MAIL_TENANT_ID: ${{ secrets.TEST_CLEAN_TENANT_ID }}
