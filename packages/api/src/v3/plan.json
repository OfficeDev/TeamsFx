{
  "name": "teams-bot.provision",
  "type": "group",
  "mode": "sequential",
  "actions": [
    {
      "type": "group",
      "mode": "sequential",
      "actions": [
        {
          "type": "call",
          "required": false,
          "targetAction": "aad.provision"
        },
        {
          "type": "call",
          "required": true,
          "targetAction": "azure-web-app.provision",
          "inputs": {
            "webApp.appSettings.M365_CLIENT_ID": "aad.clientId",
            "webApp.appSettings.M365_CLIENT_SECRET": "aad.clientSecret"
          }
        }
      ]
    },
    {
      "type": "group",
      "mode": "parallel",
      "actions": [
        {
          "type": "group",
          "mode": "sequential",
          "actions": [
            {
              "type": "call",
              "required": true,
              "targetAction": "azure-bot-service.provision",
              "inputs": {
                "bot.endpoint": "webApp.endpoint"
              }
            },
            {
              "type": "call",
              "required": true,
              "targetAction": "teams-manifest.provision",
              "inputs": {
                "manifest.botId": "bot.botId"
              }
            }
          ]
        },
        {
          "type": "group",
          "mode": "sequential",
          "actions": [
            {
              "type": "function"
            },
            {
              "type": "call",
              "required": false,
              "targetAction": "aad.configure"
            }
          ]
        }
      ]
    }
  ]
}