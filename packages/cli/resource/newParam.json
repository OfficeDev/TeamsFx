{
    "data": {
        "type": "group"
    },
    "children": [
        {
            "data": {
                "type": "folder",
                "name": "folder",
                "title": "Select root folder of the project"
            }
        },
        {
            "data": {
                "type": "text",
                "name": "app-name",
                "title": "App Name",
                "validation": {
                    "namespace": "",
                    "method": "validateAppName"
                },
                "default": "myapp"
            }
        },
        {
            "data": {
                "type": "singleSelect",
                "name": "solution",
                "title": "Select a solution",
                "option": [
                    "fx-solution-azure"
                ],
                "skipSingleOption": true
            },
            "children": [
                {
                    "data": {
                        "type": "group"
                    },
                    "children": [
                        {
                            "data": {
                                "name": "host-type",
                                "title": "Select frontend hosting type",
                                "type": "singleSelect",
                                "option": [
                                    {
                                        "id": "Azure",
                                        "label": "Azure",
                                        "cliName": "azure",
                                        "description": "Azure Cloud"
                                    },
                                    {
                                        "id": "SPFx",
                                        "label": "SPFx",
                                        "cliName": "spfx",
                                        "description": "SharePoint Framework"
                                    }
                                ],
                                "default": "Azure"
                            },
                            "children": [
                                {
                                    "data": {
                                        "type": "group"
                                    },
                                    "children": [
                                        {
                                            "data": {
                                                "type": "singleSelect",
                                                "name": "spfx-framework-type",
                                                "title": "Select framework",
                                                "option": [
                                                    "none",
                                                    "react"
                                                ],
                                                "default": "none"
                                            }
                                        },
                                        {
                                            "data": {
                                                "type": "text",
                                                "name": "spfx-webpart-name",
                                                "title": "Webpart Name",
                                                "default": "helloworld",
                                                "validation": {
                                                    "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$"
                                                }
                                            }
                                        },
                                        {
                                            "data": {
                                                "type": "text",
                                                "name": "spfx-webpart-desp",
                                                "title": "Webpart Description",
                                                "default": "helloworld description",
                                                "validation": {
                                                    "required": true
                                                }
                                            }
                                        }
                                    ],
                                    "condition": {
                                        "equals": "SPFx"
                                    }
                                },
                                {
                                    "data": {
                                        "type": "group",
                                        "name": "azure-node"
                                    },
                                    "condition": {
                                        "equals": "Azure"
                                    },
                                    "children": [
                                        {
                                            "data": {
                                                "name": "capabilities",
                                                "title": "Select capabilities to add",
                                                "prompt": "Bot and Message Extension are exclusive, you can not select both.",
                                                "type": "multiSelect",
                                                "option": [
                                                    {
                                                        "id": "Tab",
                                                        "label": "Tab",
                                                        "cliName": "tab",
                                                        "description": "Tabs embeds a web app experience in a tab in a Teams chat, channel, or personal workspace."
                                                    },
                                                    {
                                                        "id": "Bot",
                                                        "label": "Bot",
                                                        "cliName": "bot",
                                                        "description": "Bots allow you to interact with and obtain information in a text/search/conversational manner."
                                                    },
                                                    {
                                                        "id": "MessageExtension",
                                                        "label": "Messaging Extension",
                                                        "description": "Messaging Extensions allow users to interact with a web service through buttons and forms in the Microsoft Teams client."
                                                    }
                                                ],
                                                "default": [
                                                    "Tab"
                                                ]
                                            },
                                            "children": [
                                                {
                                                    "data": {
                                                        "type": "group"
                                                    },
                                                    "children": [
                                                        {
                                                            "data": {
                                                                "name": "azure-resources",
                                                                "title": "Select Azure resources to add",
                                                                "type": "multiSelect",
                                                                "option": [
                                                                    {
                                                                        "id": "sql",
                                                                        "label": "Azure SQL Database",
                                                                        "description": "Azure SQL Database depends on Azure Functions."
                                                                    },
                                                                    {
                                                                        "id": "function",
                                                                        "label": "Azure Functions",
                                                                        "description": "Application backend."
                                                                    }
                                                                ],
                                                                "default": [],
                                                                "prompt": "SQL must have Azure Function as Backend"
                                                            },
                                                            "children": []
                                                        }
                                                    ],
                                                    "condition": {
                                                        "contains": "Tab"
                                                    }
                                                },
                                                {
                                                    "data": {
                                                        "type": "group"
                                                    },
                                                    "children": [
                                                        {
                                                            "data": {
                                                                "name": "way-to-register-bot",
                                                                "type": "singleSelect",
                                                                "option": [
                                                                    {
                                                                        "id": "create-new",
                                                                        "label": "Create a new bot registration"
                                                                    },
                                                                    {
                                                                        "id": "reuse-existing",
                                                                        "label": "Use an existing bot registration"
                                                                    }
                                                                ],
                                                                "title": "Bot registration",
                                                                "default": "create-new"
                                                            },
                                                            "children": [
                                                                {
                                                                    "data": {
                                                                        "type": "group"
                                                                    },
                                                                    "children": [
                                                                        {
                                                                            "data": {
                                                                                "name": "bot-id",
                                                                                "type": "text",
                                                                                "title": "Enter bot id",
                                                                                "default": "",
                                                                                "validation": {}
                                                                            }
                                                                        },
                                                                        {
                                                                            "data": {
                                                                                "name": "bot-password",
                                                                                "type": "password",
                                                                                "title": "Enter bot password",
                                                                                "default": "",
                                                                                "validation": {}
                                                                            }
                                                                        }
                                                                    ],
                                                                    "condition": {
                                                                        "equals": "reuse-existing"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ],
                                                    "condition": {
                                                        "containsAny": [
                                                            "Bot",
                                                            "MessageExtension"
                                                        ]
                                                    }
                                                },
                                                {
                                                    "data": {
                                                        "name": "programming-language",
                                                        "title": "Select programming language for your project",
                                                        "type": "singleSelect",
                                                        "option": [
                                                            "javascript",
                                                            "typescript"
                                                        ],
                                                        "default": "javascript",
                                                        "skipSingleOption": true
                                                    },
                                                    "condition": {
                                                        "minItems": 1
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "condition": {
                        "equals": "fx-solution-azure"
                    }
                }
            ]
        }
    ]
}
