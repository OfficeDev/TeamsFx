{
    "name": "fx.provision",
    "type": "group",
    "actions": [
        {
            "type": "function",
            "name": "fx.commonConfig"
        },
        {
            "type": "group",
            "name": "resources.provision",
            "mode": "parallel",
            "actions": [
                {
                    "type": "call",
                    "name": "call:azure-storage.provision",
                    "required": false,
                    "targetAction": "azure-storage.provision"
                },
                {
                    "type": "call",
                    "name": "call:azure-web-app.provision",
                    "required": false,
                    "targetAction": "azure-web-app.provision"
                },
                {
                    "type": "call",
                    "name": "call:aad.provision",
                    "required": false,
                    "targetAction": "aad.provision"
                }
            ]
        },
        {
            "type": "call",
            "name": "call:fx.deployBicep",
            "required": true,
            "targetAction": "fx.deployBicep"
        },
        {
            "type": "call",
            "name": "call:azure-bot.provision",
            "required": false,
            "targetAction": "azure-bot.provision"
        },
        {
            "type": "function",
            "name": "prepare inputs for configuration stage"
        },
        {
            "type": "group",
            "name": "resources.configure",
            "mode": "parallel",
            "actions": [
                {
                    "type": "call",
                    "name": "call:azure-storage.configure",
                    "required": false,
                    "targetAction": "azure-storage.configure"
                },
                {
                    "type": "call",
                    "name": "call:azure-web-app.configure",
                    "required": false,
                    "targetAction": "azure-web-app.configure"
                },
                {
                    "type": "call",
                    "name": "call:aad.configure",
                    "required": false,
                    "targetAction": "aad.configure"
                }
            ]
        },
        {
            "type": "call",
            "name": "call:teams-manifest.provision",
            "required": true,
            "targetAction": "teams-manifest.provision",
            "inputs": {
                "teams-manifest": {
                    "tabEndpoint": "{{azure-storage.endpoint}}",
                    "botId": "{{azure-bot.botId}}"
                }
            }
        }
    ]
}